# üîî –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏ –æ–ø—Ä–æ—Å –ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–µ–º–µ. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Telegram —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –æ–ø—Ä–æ—Å–∞.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–æ–¥–µ–ª–∏

#### `NotificationCampaign`
- **topic** - FK –Ω–∞ Poll (—Ç–µ–º–∞ –æ–ø—Ä–æ—Å–∞)
- **total_users** - –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- **sent_users** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **status** - —Å—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–∏ (pending, processing, completed, failed)
- **created_at**, **started_at**, **completed_at** - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
- **error_message** - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

### Celery Tasks

#### `start_notification_campaign_task`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–º–ø–∞–Ω–∏–∏
- **–õ–∏–º–∏—Ç—ã**: 30 –º–∏–Ω—É—Ç soft, 35 –º–∏–Ω—É—Ç hard
- **–õ–æ–≥–∏–∫–∞**:
  1. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï –∑–∞–≤–µ—Ä—à–∏–ª–∏ –æ–ø—Ä–æ—Å
  2. –†–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ –≥—Ä—É–ø–ø—ã –ø–æ 100 —á–µ–ª–æ–≤–µ–∫
  3. –ó–∞–ø—É—Å–∫–∞–µ—Ç –¥–æ—á–µ—Ä–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 2 —Å–µ–∫—É–Ω–¥—ã

#### `send_notifications_chunk_task`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≥—Ä—É–ø–ø–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–õ–∏–º–∏—Ç—ã**: 5 –º–∏–Ω—É—Ç soft, 6 –º–∏–Ω—É—Ç hard
- **–õ–æ–≥–∏–∫–∞**:
  1. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  2. –ü–∞—É–∑–∞ 1 —Å–µ–∫—É–Ω–¥–∞ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–∞–º–∏
  3. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

1. –ó–∞–π–¥–∏—Ç–µ –≤ Django Admin ‚Üí –ö–∞–º–ø–∞–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. –ù–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É (–æ–ø—Ä–æ—Å)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### 2. –ó–∞–ø—É—Å–∫ –∫–∞–º–ø–∞–Ω–∏–∏

1. –í —Å–ø–∏—Å–∫–µ –∫–∞–º–ø–∞–Ω–∏–π –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é
2. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **–°—Ç–∞—Ç—É—Å**: pending ‚Üí processing ‚Üí completed/failed
- **–ü—Ä–æ–≥—Ä–µ—Å—Å**: –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–õ–æ–≥–∏**: –≤ Celery worker –∏ Flower

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –õ–∏–º–∏—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
```python
# –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞
CELERY_TASK_TIME_LIMIT = 30 * 60  # 30 –º–∏–Ω—É—Ç
CELERY_TASK_SOFT_TIME_LIMIT = 25 * 60  # 25 –º–∏–Ω—É—Ç

# –î–æ—á–µ—Ä–Ω–∏–µ –∑–∞–¥–∞—á–∏
soft_time_limit = 300  # 5 –º–∏–Ω—É—Ç
time_limit = 360  # 6 –º–∏–Ω—É—Ç
```

### –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ—Ç–ø—Ä–∞–≤–∫–∏
- **–ú–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏**: 2 —Å–µ–∫—É–Ω–¥—ã
- **–ú–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**: 1 —Å–µ–∫—É–Ω–¥–∞
- **–†–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø—ã**: 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å
- –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ —Ä–∞–∑–±–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É –Ω–∞ —á–∞—Å—Ç–∏
- –î–æ—á–µ—Ä–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- –ö–∞–∂–¥–∞—è –≥—Ä—É–ø–ø–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –¢–∞–π–º–∞—É—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `SoftTimeLimitExceeded`
- –û—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –≤—Å—é –∫–∞–º–ø–∞–Ω–∏—é
- –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —É–∂–µ –∑–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö –æ–ø—Ä–æ—Å
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Flower
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –î–µ—Ç–∞–ª–∏ –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ

### Django Admin
- –°—Ç–∞—Ç—É—Å –∫–∞–º–ø–∞–Ω–∏–π
- –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –û—à–∏–±–∫–∏ –∏ –ª–æ–≥–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
python3 test_notification_system.py
```

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **Telegram API**: –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã Telegram API
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ë–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
3. **Celery**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ worker'—ã –∑–∞–ø—É—â–µ–Ω—ã
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –°–ª–µ–¥–∏—Ç–µ –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º –∫–∞–º–ø–∞–Ω–∏–π

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—á–µ—Ç—á–∏–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –û—Ç–º–µ—á–∞–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –∏ —Ç–∞–π–º–∞—É—Ç—ã
- –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
